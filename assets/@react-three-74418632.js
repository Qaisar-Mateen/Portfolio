import{r as d,j as G}from"./react-59448373.js";import{L as _e,T as We,R as Vt,U as qt,B as Xt,M as Yt,C as Zt,a as Kt,O as Ue,P as Ge,S as tt,b as Me,N as Jt,A as Qt,W as er,c as tr,d as rr,e as nr,V as or,f as W,g as gt,h as ir,i as sr,D as ar,j as be,k as Ve,l as cr,E as yt,m as lr,n as ur,o as fr,p as dr,q as ce,r as pr,s as mr,t as vr}from"./three-51ba63ee.js";import{c as rt}from"./debounce-ed1231a5.js";import{F as hr,u as gr}from"./its-fine-0b6cae9d.js";import{R as yr,c as ae}from"./react-reconciler-2b7e3e2b.js";import{s as nt}from"./scheduler-765c72db.js";import{_ as K}from"./@babel-4c19d496.js";import{c as br}from"./react-dom-2e13f63e.js";import{c as wr}from"./zustand-829bd73a.js";import"./maath-ec4472e0.js";import{D as Er,G as qe,a as xr,M as Re,O as Sr}from"./three-stdlib-06390ee4.js";import{s as Cr,p as Pr,c as _r}from"./suspend-react-4f9dedb1.js";function Mr(e){let t;const r=new Set,i=(p,n)=>{const o=typeof p=="function"?p(t):p;if(o!==t){const l=t;t=n?o:Object.assign({},t,o),r.forEach(h=>h(t,l))}},a=()=>t,s=(p,n=a,o=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let l=n(t);function h(){const g=n(t);if(!o(l,g)){const b=l;p(l=g,b)}}return r.add(h),()=>r.delete(h)},f={setState:i,getState:a,subscribe:(p,n,o)=>n||o?s(p,n,o):(r.add(p),()=>r.delete(p)),destroy:()=>r.clear()};return t=e(i,a,f),f}const Rr=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),ot=Rr?d.useEffect:d.useLayoutEffect;function Or(e){const t=typeof e=="function"?Mr(e):e,r=(i=t.getState,a=Object.is)=>{const[,s]=d.useReducer(y=>y+1,0),m=t.getState(),u=d.useRef(m),f=d.useRef(i),p=d.useRef(a),n=d.useRef(!1),o=d.useRef();o.current===void 0&&(o.current=i(m));let l,h=!1;(u.current!==m||f.current!==i||p.current!==a||n.current)&&(l=i(m),h=!a(o.current,l)),ot(()=>{h&&(o.current=l),u.current=m,f.current=i,p.current=a,n.current=!1});const g=d.useRef(m);ot(()=>{const y=()=>{try{const v=t.getState(),E=f.current(v);p.current(o.current,E)||(u.current=v,o.current=E,s())}catch{n.current=!0,s()}},c=t.subscribe(y);return t.getState()!==g.current&&y(),c},[]);const b=h?l:o.current;return d.useDebugValue(b),b};return Object.assign(r,t),r[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[r,t];return{next(){const a=i.length<=0;return{value:i.shift(),done:a}}}},r}const Xe={},jr=e=>void Object.assign(Xe,e);function Ar(e,t){function r(n,{args:o=[],attach:l,...h},g){let b=`${n[0].toUpperCase()}${n.slice(1)}`,y;if(n==="primitive"){if(h.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const c=h.object;y=ie(c,{type:n,root:g,attach:l,primitive:!0})}else{const c=Xe[b];if(!c)throw new Error(`R3F: ${b} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(o))throw new Error("R3F: The args prop must be an array!");y=ie(new c(...o),{type:n,root:g,attach:l,memoizedProps:{args:o}})}return y.__r3f.attach===void 0&&(y instanceof Xt?y.__r3f.attach="geometry":y instanceof Yt&&(y.__r3f.attach="material")),b!=="inject"&&Ae(y,h),y}function i(n,o){let l=!1;if(o){var h,g;(h=o.__r3f)!=null&&h.attach?je(n,o,o.__r3f.attach):o.isObject3D&&n.isObject3D&&(n.add(o),l=!0),l||(g=n.__r3f)==null||g.objects.push(o),o.__r3f||ie(o,{}),o.__r3f.parent=n,$e(o),se(o)}}function a(n,o,l){let h=!1;if(o){var g,b;if((g=o.__r3f)!=null&&g.attach)je(n,o,o.__r3f.attach);else if(o.isObject3D&&n.isObject3D){o.parent=n,o.dispatchEvent({type:"added"}),n.dispatchEvent({type:"childadded",child:o});const y=n.children.filter(v=>v!==o),c=y.indexOf(l);n.children=[...y.slice(0,c),o,...y.slice(c)],h=!0}h||(b=n.__r3f)==null||b.objects.push(o),o.__r3f||ie(o,{}),o.__r3f.parent=n,$e(o),se(o)}}function s(n,o,l=!1){n&&[...n].forEach(h=>m(o,h,l))}function m(n,o,l){if(o){var h,g,b;if(o.__r3f&&(o.__r3f.parent=null),(h=n.__r3f)!=null&&h.objects&&(n.__r3f.objects=n.__r3f.objects.filter(P=>P!==o)),(g=o.__r3f)!=null&&g.attach)lt(n,o,o.__r3f.attach);else if(o.isObject3D&&n.isObject3D){var y;n.remove(o),(y=o.__r3f)!=null&&y.root&&Wr(Se(o),o)}const v=(b=o.__r3f)==null?void 0:b.primitive,E=!v&&(l===void 0?o.dispose!==null:l);if(!v){var c;s((c=o.__r3f)==null?void 0:c.objects,o,E),s(o.children,o,E)}if(delete o.__r3f,E&&o.dispose&&o.type!=="Scene"){const P=()=>{try{o.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?nt.unstable_scheduleCallback(nt.unstable_IdlePriority,P):P()}se(n)}}function u(n,o,l,h){var g;const b=(g=n.__r3f)==null?void 0:g.parent;if(!b)return;const y=r(o,l,n.__r3f.root);if(n.children){for(const c of n.children)c.__r3f&&i(y,c);n.children=n.children.filter(c=>!c.__r3f)}n.__r3f.objects.forEach(c=>i(y,c)),n.__r3f.objects=[],n.__r3f.autoRemovedBeforeAppend||m(b,n),y.parent&&(y.__r3f.autoRemovedBeforeAppend=!0),i(b,y),y.raycast&&y.__r3f.eventCount&&Se(y).getState().internal.interaction.push(y),[h,h.alternate].forEach(c=>{c!==null&&(c.stateNode=y,c.ref&&(typeof c.ref=="function"?c.ref(y):c.ref.current=y))})}const f=()=>{};return{reconciler:yr({createInstance:r,removeChild:m,appendChild:i,appendInitialChild:i,insertBefore:a,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(n,o)=>{if(!o)return;const l=n.getState().scene;l.__r3f&&(l.__r3f.root=n,i(l,o))},removeChildFromContainer:(n,o)=>{o&&m(n.getState().scene,o)},insertInContainerBefore:(n,o,l)=>{if(!o||!l)return;const h=n.getState().scene;h.__r3f&&a(h,o,l)},getRootHostContext:()=>null,getChildHostContext:n=>n,finalizeInitialChildren(n){var o;return!!((o=n==null?void 0:n.__r3f)!=null?o:{}).handlers},prepareUpdate(n,o,l,h){var g;if(((g=n==null?void 0:n.__r3f)!=null?g:{}).primitive&&h.object&&h.object!==n)return[!0];{const{args:y=[],children:c,...v}=h,{args:E=[],children:P,...S}=l;if(!Array.isArray(y))throw new Error("R3F: the args prop must be an array!");if(y.some((R,O)=>R!==E[O]))return[!0];const x=Pt(n,v,S,!0);return x.changes.length?[!1,x]:null}},commitUpdate(n,[o,l],h,g,b,y){o?u(n,h,b,y):Ae(n,l)},commitMount(n,o,l,h){var g;const b=(g=n.__r3f)!=null?g:{};n.raycast&&b.handlers&&b.eventCount&&Se(n).getState().internal.interaction.push(n)},getPublicInstance:n=>n,prepareForCommit:()=>null,preparePortalMount:n=>ie(n.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(n){var o;const{attach:l,parent:h}=(o=n.__r3f)!=null?o:{};l&&h&&lt(h,n,l),n.isObject3D&&(n.visible=!1),se(n)},unhideInstance(n,o){var l;const{attach:h,parent:g}=(l=n.__r3f)!=null?l:{};h&&g&&je(g,n,h),(n.isObject3D&&o.visible==null||o.visible)&&(n.visible=!0),se(n)},createTextInstance:f,hideTextInstance:f,unhideTextInstance:f,getCurrentEventPriority:()=>t?t():ae.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&T.fun(performance.now)?performance.now:T.fun(Date.now)?Date.now:()=>0,scheduleTimeout:T.fun(setTimeout)?setTimeout:void 0,cancelTimeout:T.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Ae}}var it,st;const Oe=e=>"colorSpace"in e||"outputColorSpace"in e,bt=()=>{var e;return(e=Xe.ColorManagement)!=null?e:null},wt=e=>e&&e.isOrthographicCamera,Lr=e=>e&&e.hasOwnProperty("current"),ve=typeof window<"u"&&((it=window.document)!=null&&it.createElement||((st=window.navigator)==null?void 0:st.product)==="ReactNative")?d.useLayoutEffect:d.useEffect;function Et(e){const t=d.useRef(e);return ve(()=>void(t.current=e),[e]),t}function Tr({set:e}){return ve(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class xt extends d.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}xt.getDerivedStateFromError=()=>({error:!0});const St="__default",at=new Map,Dr=e=>e&&!!e.memoized&&!!e.changes;function Ct(e){var t;const r=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],r),e[1]):e}const fe=e=>{var t;return(t=e.__r3f)==null?void 0:t.root.getState()};function Se(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const T={obj:e=>e===Object(e)&&!T.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,t,{arrays:r="shallow",objects:i="reference",strict:a=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(T.str(e)||T.num(e)||T.boo(e))return e===t;const s=T.obj(e);if(s&&i==="reference")return e===t;const m=T.arr(e);if(m&&r==="reference")return e===t;if((m||s)&&e===t)return!0;let u;for(u in e)if(!(u in t))return!1;if(s&&r==="shallow"&&i==="shallow"){for(u in a?t:e)if(!T.equ(e[u],t[u],{strict:a,objects:"reference"}))return!1}else for(u in a?t:e)if(e[u]!==t[u])return!1;if(T.und(u)){if(m&&e.length===0&&t.length===0||s&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function zr(e){const t={nodes:{},materials:{}};return e&&e.traverse(r=>{r.name&&(t.nodes[r.name]=r),r.material&&!t.materials[r.material.name]&&(t.materials[r.material.name]=r.material)}),t}function kr(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const t in e)t.dispose==null||t.dispose(),delete e[t]}function ie(e,t){const r=e;return r.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function Be(e,t){let r=e;if(t.includes("-")){const i=t.split("-"),a=i.pop();return r=i.reduce((s,m)=>s[m],e),{target:r,key:a}}else return{target:r,key:t}}const ct=/-\d+$/;function je(e,t,r){if(T.str(r)){if(ct.test(r)){const s=r.replace(ct,""),{target:m,key:u}=Be(e,s);Array.isArray(m[u])||(m[u]=[])}const{target:i,key:a}=Be(e,r);t.__r3f.previousAttach=i[a],i[a]=t}else t.__r3f.previousAttach=r(e,t)}function lt(e,t,r){var i,a;if(T.str(r)){const{target:s,key:m}=Be(e,r),u=t.__r3f.previousAttach;u===void 0?delete s[m]:s[m]=u}else(i=t.__r3f)==null||i.previousAttach==null||i.previousAttach(e,t);(a=t.__r3f)==null||delete a.previousAttach}function Pt(e,{children:t,key:r,ref:i,...a},{children:s,key:m,ref:u,...f}={},p=!1){const n=e.__r3f,o=Object.entries(a),l=[];if(p){const g=Object.keys(f);for(let b=0;b<g.length;b++)a.hasOwnProperty(g[b])||o.unshift([g[b],St+"remove"])}o.forEach(([g,b])=>{var y;if((y=e.__r3f)!=null&&y.primitive&&g==="object"||T.equ(b,f[g]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(g))return l.push([g,b,!0,[]]);let c=[];g.includes("-")&&(c=g.split("-")),l.push([g,b,!1,c]);for(const v in a){const E=a[v];v.startsWith(`${g}-`)&&l.push([v,E,!1,v.split("-")])}});const h={...a};return n!=null&&n.memoizedProps&&n!=null&&n.memoizedProps.args&&(h.args=n.memoizedProps.args),n!=null&&n.memoizedProps&&n!=null&&n.memoizedProps.attach&&(h.attach=n.memoizedProps.attach),{memoized:h,changes:l}}const Fr=typeof process<"u"&&!1;function Ae(e,t){var r;const i=e.__r3f,a=i==null?void 0:i.root,s=a==null||a.getState==null?void 0:a.getState(),{memoized:m,changes:u}=Dr(t)?t:Pt(e,t),f=i==null?void 0:i.eventCount;e.__r3f&&(e.__r3f.memoizedProps=m);for(let n=0;n<u.length;n++){let[o,l,h,g]=u[n];if(Oe(e)){const v="srgb",E="srgb-linear";o==="encoding"?(o="colorSpace",l=l===3001?v:E):o==="outputEncoding"&&(o="outputColorSpace",l=l===3001?v:E)}let b=e,y=b[o];if(g.length&&(y=g.reduce((c,v)=>c[v],e),!(y&&y.set))){const[c,...v]=g.reverse();b=v.reverse().reduce((E,P)=>E[P],e),o=c}if(l===St+"remove")if(b.constructor){let c=at.get(b.constructor);c||(c=new b.constructor,at.set(b.constructor,c)),l=c[o]}else l=0;if(h&&i)l?i.handlers[o]=l:delete i.handlers[o],i.eventCount=Object.keys(i.handlers).length;else if(y&&y.set&&(y.copy||y instanceof _e)){if(Array.isArray(l))y.fromArray?y.fromArray(l):y.set(...l);else if(y.copy&&l&&l.constructor&&(Fr?y.constructor.name===l.constructor.name:y.constructor===l.constructor))y.copy(l);else if(l!==void 0){const c=y instanceof Zt;!c&&y.setScalar?y.setScalar(l):y instanceof _e&&l instanceof _e?y.mask=l.mask:y.set(l),!bt()&&s&&!s.linear&&c&&y.convertSRGBToLinear()}}else if(b[o]=l,b[o]instanceof We&&b[o].format===Vt&&b[o].type===qt&&s){const c=b[o];Oe(c)&&Oe(s.gl)?c.colorSpace=s.gl.outputColorSpace:c.encoding=s.gl.outputEncoding}se(e)}if(i&&i.parent&&e.raycast&&f!==i.eventCount){const n=Se(e).getState().internal,o=n.interaction.indexOf(e);o>-1&&n.interaction.splice(o,1),i.eventCount&&n.interaction.push(e)}return!(u.length===1&&u[0][0]==="onUpdate")&&u.length&&(r=e.__r3f)!=null&&r.parent&&$e(e),e}function se(e){var t,r;const i=(t=e.__r3f)==null||(r=t.root)==null||r.getState==null?void 0:r.getState();i&&i.internal.frames===0&&i.invalidate()}function $e(e){e.onUpdate==null||e.onUpdate(e)}function Hr(e,t){e.manual||(wt(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function we(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Ir(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return ae.DefaultEventPriority;switch((e=t.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return ae.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return ae.ContinuousEventPriority;default:return ae.DefaultEventPriority}}function _t(e,t,r,i){const a=r.get(t);a&&(r.delete(t),r.size===0&&(e.delete(i),a.target.releasePointerCapture(i)))}function Wr(e,t){const{internal:r}=e.getState();r.interaction=r.interaction.filter(i=>i!==t),r.initialHits=r.initialHits.filter(i=>i!==t),r.hovered.forEach((i,a)=>{(i.eventObject===t||i.object===t)&&r.hovered.delete(a)}),r.capturedMap.forEach((i,a)=>{_t(r.capturedMap,t,i,a)})}function Br(e){function t(f){const{internal:p}=e.getState(),n=f.offsetX-p.initialClick[0],o=f.offsetY-p.initialClick[1];return Math.round(Math.sqrt(n*n+o*o))}function r(f){return f.filter(p=>["Move","Over","Enter","Out","Leave"].some(n=>{var o;return(o=p.__r3f)==null?void 0:o.handlers["onPointer"+n]}))}function i(f,p){const n=e.getState(),o=new Set,l=[],h=p?p(n.internal.interaction):n.internal.interaction;for(let c=0;c<h.length;c++){const v=fe(h[c]);v&&(v.raycaster.camera=void 0)}n.previousRoot||n.events.compute==null||n.events.compute(f,n);function g(c){const v=fe(c);if(!v||!v.events.enabled||v.raycaster.camera===null)return[];if(v.raycaster.camera===void 0){var E;v.events.compute==null||v.events.compute(f,v,(E=v.previousRoot)==null?void 0:E.getState()),v.raycaster.camera===void 0&&(v.raycaster.camera=null)}return v.raycaster.camera?v.raycaster.intersectObject(c,!0):[]}let b=h.flatMap(g).sort((c,v)=>{const E=fe(c.object),P=fe(v.object);return!E||!P?c.distance-v.distance:P.events.priority-E.events.priority||c.distance-v.distance}).filter(c=>{const v=we(c);return o.has(v)?!1:(o.add(v),!0)});n.events.filter&&(b=n.events.filter(b,n));for(const c of b){let v=c.object;for(;v;){var y;(y=v.__r3f)!=null&&y.eventCount&&l.push({...c,eventObject:v}),v=v.parent}}if("pointerId"in f&&n.internal.capturedMap.has(f.pointerId))for(let c of n.internal.capturedMap.get(f.pointerId).values())o.has(we(c.intersection))||l.push(c.intersection);return l}function a(f,p,n,o){const l=e.getState();if(f.length){const h={stopped:!1};for(const g of f){const b=fe(g.object)||l,{raycaster:y,pointer:c,camera:v,internal:E}=b,P=new W(c.x,c.y,0).unproject(v),S=_=>{var w,M;return(w=(M=E.capturedMap.get(_))==null?void 0:M.has(g.eventObject))!=null?w:!1},x=_=>{const w={intersection:g,target:p.target};E.capturedMap.has(_)?E.capturedMap.get(_).set(g.eventObject,w):E.capturedMap.set(_,new Map([[g.eventObject,w]])),p.target.setPointerCapture(_)},R=_=>{const w=E.capturedMap.get(_);w&&_t(E.capturedMap,g.eventObject,w,_)};let O={};for(let _ in p){let w=p[_];typeof w!="function"&&(O[_]=w)}let C={...g,...O,pointer:c,intersections:f,stopped:h.stopped,delta:n,unprojectedPoint:P,ray:y.ray,camera:v,stopPropagation(){const _="pointerId"in p&&E.capturedMap.get(p.pointerId);if((!_||_.has(g.eventObject))&&(C.stopped=h.stopped=!0,E.hovered.size&&Array.from(E.hovered.values()).find(w=>w.eventObject===g.eventObject))){const w=f.slice(0,f.indexOf(g));s([...w,g])}},target:{hasPointerCapture:S,setPointerCapture:x,releasePointerCapture:R},currentTarget:{hasPointerCapture:S,setPointerCapture:x,releasePointerCapture:R},nativeEvent:p};if(o(C),h.stopped===!0)break}}return f}function s(f){const{internal:p}=e.getState();for(const n of p.hovered.values())if(!f.length||!f.find(o=>o.object===n.object&&o.index===n.index&&o.instanceId===n.instanceId)){const l=n.eventObject.__r3f,h=l==null?void 0:l.handlers;if(p.hovered.delete(we(n)),l!=null&&l.eventCount){const g={...n,intersections:f};h.onPointerOut==null||h.onPointerOut(g),h.onPointerLeave==null||h.onPointerLeave(g)}}}function m(f,p){for(let n=0;n<p.length;n++){const o=p[n].__r3f;o==null||o.handlers.onPointerMissed==null||o.handlers.onPointerMissed(f)}}function u(f){switch(f){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return p=>{const{internal:n}=e.getState();"pointerId"in p&&n.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{n.capturedMap.has(p.pointerId)&&(n.capturedMap.delete(p.pointerId),s([]))})}}return function(n){const{onPointerMissed:o,internal:l}=e.getState();l.lastEvent.current=n;const h=f==="onPointerMove",g=f==="onClick"||f==="onContextMenu"||f==="onDoubleClick",y=i(n,h?r:void 0),c=g?t(n):0;f==="onPointerDown"&&(l.initialClick=[n.offsetX,n.offsetY],l.initialHits=y.map(E=>E.eventObject)),g&&!y.length&&c<=2&&(m(n,l.interaction),o&&o(n)),h&&s(y);function v(E){const P=E.eventObject,S=P.__r3f,x=S==null?void 0:S.handlers;if(S!=null&&S.eventCount)if(h){if(x.onPointerOver||x.onPointerEnter||x.onPointerOut||x.onPointerLeave){const R=we(E),O=l.hovered.get(R);O?O.stopped&&E.stopPropagation():(l.hovered.set(R,E),x.onPointerOver==null||x.onPointerOver(E),x.onPointerEnter==null||x.onPointerEnter(E))}x.onPointerMove==null||x.onPointerMove(E)}else{const R=x[f];R?(!g||l.initialHits.includes(P))&&(m(n,l.interaction.filter(O=>!l.initialHits.includes(O))),R(E)):g&&l.initialHits.includes(P)&&m(n,l.interaction.filter(O=>!l.initialHits.includes(O)))}}a(y,n,c,v)}}return{handlePointer:u}}const Mt=e=>!!(e!=null&&e.render),Rt=d.createContext(null),$r=(e,t)=>{const r=Or((u,f)=>{const p=new W,n=new W,o=new W;function l(c=f().camera,v=n,E=f().size){const{width:P,height:S,top:x,left:R}=E,O=P/S;v instanceof W?o.copy(v):o.set(...v);const C=c.getWorldPosition(p).distanceTo(o);if(wt(c))return{width:P/c.zoom,height:S/c.zoom,top:x,left:R,factor:1,distance:C,aspect:O};{const _=c.fov*Math.PI/180,w=2*Math.tan(_/2)*C,M=w*(P/S);return{width:M,height:w,top:x,left:R,factor:P/M,distance:C,aspect:O}}}let h;const g=c=>u(v=>({performance:{...v.performance,current:c}})),b=new gt;return{set:u,get:f,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(c=1)=>e(f(),c),advance:(c,v)=>t(c,v,f()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new ir,pointer:b,mouse:b,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const c=f();h&&clearTimeout(h),c.performance.current!==c.performance.min&&g(c.performance.min),h=setTimeout(()=>g(f().performance.max),c.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:c=>u(v=>({...v,events:{...v.events,...c}})),setSize:(c,v,E,P,S)=>{const x=f().camera,R={width:c,height:v,top:P||0,left:S||0,updateStyle:E};u(O=>({size:R,viewport:{...O.viewport,...l(x,n,R)}}))},setDpr:c=>u(v=>{const E=Ct(c);return{viewport:{...v.viewport,dpr:E,initialDpr:v.viewport.initialDpr||E}}}),setFrameloop:(c="always")=>{const v=f().clock;v.stop(),v.elapsedTime=0,c!=="never"&&(v.start(),v.elapsedTime=0),u(()=>({frameloop:c}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:d.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(c,v,E)=>{const P=f().internal;return P.priority=P.priority+(v>0?1:0),P.subscribers.push({ref:c,priority:v,store:E}),P.subscribers=P.subscribers.sort((S,x)=>S.priority-x.priority),()=>{const S=f().internal;S!=null&&S.subscribers&&(S.priority=S.priority-(v>0?1:0),S.subscribers=S.subscribers.filter(x=>x.ref!==c))}}}}}),i=r.getState();let a=i.size,s=i.viewport.dpr,m=i.camera;return r.subscribe(()=>{const{camera:u,size:f,viewport:p,gl:n,set:o}=r.getState();if(f.width!==a.width||f.height!==a.height||p.dpr!==s){var l;a=f,s=p.dpr,Hr(u,f),n.setPixelRatio(p.dpr);const h=(l=f.updateStyle)!=null?l:typeof HTMLCanvasElement<"u"&&n.domElement instanceof HTMLCanvasElement;n.setSize(f.width,f.height,h)}u!==m&&(m=u,o(h=>({viewport:{...h.viewport,...h.viewport.getCurrentViewport(u)}})))}),r.subscribe(u=>e(u)),r};let Ee,Nr=new Set,Ur=new Set,Gr=new Set;function Le(e,t){if(e.size)for(const{callback:r}of e.values())r(t)}function de(e,t){switch(e){case"before":return Le(Nr,t);case"after":return Le(Ur,t);case"tail":return Le(Gr,t)}}let Te,De;function ze(e,t,r){let i=t.clock.getDelta();for(t.frameloop==="never"&&typeof e=="number"&&(i=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),Te=t.internal.subscribers,Ee=0;Ee<Te.length;Ee++)De=Te[Ee],De.ref.current(De.store.getState(),i,r);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}function Vr(e){let t=!1,r=!1,i,a,s;function m(p){a=requestAnimationFrame(m),t=!0,i=0,de("before",p),r=!0;for(const o of e.values()){var n;s=o.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((n=s.gl.xr)!=null&&n.isPresenting)&&(i+=ze(p,s))}if(r=!1,de("after",p),i===0)return de("tail",p),t=!1,cancelAnimationFrame(a)}function u(p,n=1){var o;if(!p)return e.forEach(l=>u(l.store.getState(),n));(o=p.gl.xr)!=null&&o.isPresenting||!p.internal.active||p.frameloop==="never"||(n>1?p.internal.frames=Math.min(60,p.internal.frames+n):r?p.internal.frames=2:p.internal.frames=1,t||(t=!0,requestAnimationFrame(m)))}function f(p,n=!0,o,l){if(n&&de("before",p),o)ze(p,o,l);else for(const h of e.values())ze(p,h.store.getState());n&&de("after",p)}return{loop:m,invalidate:u,advance:f}}function Ot(){const e=d.useContext(Rt);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function N(e=r=>r,t){return Ot()(e,t)}function he(e,t=0){const r=Ot(),i=r.getState().internal.subscribe,a=Et(e);return ve(()=>i(a,t,r),[t,i,r]),null}const ut=new WeakMap;function jt(e,t){return function(r,...i){let a=ut.get(r);return a||(a=new r,ut.set(r,a)),e&&e(a),Promise.all(i.map(s=>new Promise((m,u)=>a.load(s,f=>{f.scene&&Object.assign(f,zr(f.scene)),m(f)},t,f=>u(new Error(`Could not load ${s}: ${f==null?void 0:f.message}`))))))}}function J(e,t,r,i){const a=Array.isArray(t)?t:[t],s=Cr(jt(r,i),[e,...a],{equal:T.equ});return Array.isArray(t)?s:s[0]}J.preload=function(e,t,r){const i=Array.isArray(t)?t:[t];return Pr(jt(r),[e,...i])};J.clear=function(e,t){const r=Array.isArray(t)?t:[t];return _r([e,...r])};const le=new Map,{invalidate:ft,advance:dt}=Vr(le),{reconciler:Ce,applyProps:V}=Ar(le,Ir),oe={objects:"shallow",strict:!1},qr=(e,t)=>{const r=typeof e=="function"?e(t):e;return Mt(r)?r:new er({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function Xr(e,t){const r=typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement;if(t){const{width:i,height:a,top:s,left:m,updateStyle:u=r}=t;return{width:i,height:a,top:s,left:m,updateStyle:u}}else if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:i,height:a,top:s,left:m}=e.parentElement.getBoundingClientRect();return{width:i,height:a,top:s,left:m,updateStyle:r}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0,updateStyle:r};return{width:0,height:0,top:0,left:0}}function Yr(e){const t=le.get(e),r=t==null?void 0:t.fiber,i=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const a=typeof reportError=="function"?reportError:console.error,s=i||$r(ft,dt),m=r||Ce.createContainer(s,ae.ConcurrentRoot,null,!1,null,"",a,null);t||le.set(e,{fiber:m,store:s});let u,f=!1,p;return{configure(n={}){let{gl:o,size:l,scene:h,events:g,onCreated:b,shadows:y=!1,linear:c=!1,flat:v=!1,legacy:E=!1,orthographic:P=!1,frameloop:S="always",dpr:x=[1,2],performance:R,raycaster:O,camera:C,onPointerMissed:_}=n,w=s.getState(),M=w.gl;w.gl||w.set({gl:M=qr(o,e)});let I=w.raycaster;I||w.set({raycaster:I=new Kt});const{params:q,...z}=O||{};if(T.equ(z,I,oe)||V(I,{...z}),T.equ(q,I.params,oe)||V(I,{params:{...I.params,...q}}),!w.camera||w.camera===p&&!T.equ(p,C,oe)){p=C;const A=C instanceof tr,L=A?C:P?new Ue(0,0,0,0,.1,1e3):new Ge(75,0,.1,1e3);A||(L.position.z=5,C&&(V(L,C),("aspect"in C||"left"in C||"right"in C||"bottom"in C||"top"in C)&&(L.manual=!0,L.updateProjectionMatrix())),!w.camera&&!(C!=null&&C.rotation)&&L.lookAt(0,0,0)),w.set({camera:L}),I.camera=L}if(!w.scene){let A;h instanceof tt?A=h:(A=new tt,h&&V(A,h)),w.set({scene:ie(A)})}if(!w.xr){var U;const A=(j,Z)=>{const X=s.getState();X.frameloop!=="never"&&dt(j,!0,X,Z)},L=()=>{const j=s.getState();j.gl.xr.enabled=j.gl.xr.isPresenting,j.gl.xr.setAnimationLoop(j.gl.xr.isPresenting?A:null),j.gl.xr.isPresenting||ft(j)},B={connect(){const j=s.getState().gl;j.xr.addEventListener("sessionstart",L),j.xr.addEventListener("sessionend",L)},disconnect(){const j=s.getState().gl;j.xr.removeEventListener("sessionstart",L),j.xr.removeEventListener("sessionend",L)}};typeof((U=M.xr)==null?void 0:U.addEventListener)=="function"&&B.connect(),w.set({xr:B})}if(M.shadowMap){const A=M.shadowMap.enabled,L=M.shadowMap.type;if(M.shadowMap.enabled=!!y,T.boo(y))M.shadowMap.type=Me;else if(T.str(y)){var k;const B={basic:rr,percentage:nr,soft:Me,variance:or};M.shadowMap.type=(k=B[y])!=null?k:Me}else T.obj(y)&&Object.assign(M.shadowMap,y);(A!==M.shadowMap.enabled||L!==M.shadowMap.type)&&(M.shadowMap.needsUpdate=!0)}const F=bt();F&&("enabled"in F?F.enabled=!E:"legacyMode"in F&&(F.legacyMode=E)),f||V(M,{outputEncoding:c?3e3:3001,toneMapping:v?Jt:Qt}),w.legacy!==E&&w.set(()=>({legacy:E})),w.linear!==c&&w.set(()=>({linear:c})),w.flat!==v&&w.set(()=>({flat:v})),o&&!T.fun(o)&&!Mt(o)&&!T.equ(o,M,oe)&&V(M,o),g&&!w.events.handlers&&w.set({events:g(s)});const H=Xr(e,l);return T.equ(H,w.size,oe)||w.setSize(H.width,H.height,H.updateStyle,H.top,H.left),x&&w.viewport.dpr!==Ct(x)&&w.setDpr(x),w.frameloop!==S&&w.setFrameloop(S),w.onPointerMissed||w.set({onPointerMissed:_}),R&&!T.equ(R,w.performance,oe)&&w.set(A=>({performance:{...A.performance,...R}})),u=b,f=!0,this},render(n){return f||this.configure(),Ce.updateContainer(G.jsx(Zr,{store:s,children:n,onCreated:u,rootElement:e}),m,null,()=>{}),s},unmount(){At(e)}}}function Zr({store:e,children:t,onCreated:r,rootElement:i}){return ve(()=>{const a=e.getState();a.set(s=>({internal:{...s.internal,active:!0}})),r&&r(a),e.getState().events.connected||a.events.connect==null||a.events.connect(i)},[]),G.jsx(Rt.Provider,{value:e,children:t})}function At(e,t){const r=le.get(e),i=r==null?void 0:r.fiber;if(i){const a=r==null?void 0:r.store.getState();a&&(a.internal.active=!1),Ce.updateContainer(null,i,null,()=>{a&&setTimeout(()=>{try{var s,m,u,f;a.events.disconnect==null||a.events.disconnect(),(s=a.gl)==null||(m=s.renderLists)==null||m.dispose==null||m.dispose(),(u=a.gl)==null||u.forceContextLoss==null||u.forceContextLoss(),(f=a.gl)!=null&&f.xr&&a.xr.disconnect(),kr(a),le.delete(e),t&&t(e)}catch{}},500)})}}Ce.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:d.version});const ke={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Kr(e){const{handlePointer:t}=Br(e);return{priority:1,enabled:!0,compute(r,i,a){i.pointer.set(r.offsetX/i.size.width*2-1,-(r.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(ke).reduce((r,i)=>({...r,[i]:t(i)}),{}),update:()=>{var r;const{events:i,internal:a}=e.getState();(r=a.lastEvent)!=null&&r.current&&i.handlers&&i.handlers.onPointerMove(a.lastEvent.current)},connect:r=>{var i;const{set:a,events:s}=e.getState();s.disconnect==null||s.disconnect(),a(m=>({events:{...m.events,connected:r}})),Object.entries((i=s.handlers)!=null?i:[]).forEach(([m,u])=>{const[f,p]=ke[m];r.addEventListener(f,u,{passive:p})})},disconnect:()=>{const{set:r,events:i}=e.getState();if(i.connected){var a;Object.entries((a=i.handlers)!=null?a:[]).forEach(([s,m])=>{if(i&&i.connected instanceof HTMLElement){const[u]=ke[s];i.connected.removeEventListener(u,m)}}),r(s=>({events:{...s.events,connected:void 0}}))}}}}function Jr({debounce:e,scroll:t,polyfill:r,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const a=r||typeof window<"u"&&window.ResizeObserver,[s,m]=d.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0});if(!a)return s.width=1280,s.height=800,[()=>{},s,()=>{}];const u=d.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),f=e?typeof e=="number"?e:e.scroll:null,p=e?typeof e=="number"?e:e.resize:null,n=d.useRef(!1);d.useEffect(()=>(n.current=!0,()=>void(n.current=!1)));const[o,l,h]=d.useMemo(()=>{const c=()=>{if(!u.current.element)return;const{left:v,top:E,width:P,height:S,bottom:x,right:R,x:O,y:C}=u.current.element.getBoundingClientRect(),_={left:v,top:E,width:P,height:S,bottom:x,right:R,x:O,y:C};u.current.element instanceof HTMLElement&&i&&(_.height=u.current.element.offsetHeight,_.width=u.current.element.offsetWidth),Object.freeze(_),n.current&&!rn(u.current.lastBounds,_)&&m(u.current.lastBounds=_)};return[c,p?rt(c,p):c,f?rt(c,f):c]},[m,i,f,p]);function g(){u.current.scrollContainers&&(u.current.scrollContainers.forEach(c=>c.removeEventListener("scroll",h,!0)),u.current.scrollContainers=null),u.current.resizeObserver&&(u.current.resizeObserver.disconnect(),u.current.resizeObserver=null),u.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",u.current.orientationHandler))}function b(){var c;u.current.element&&(u.current.resizeObserver=new a(l),(c=u.current.resizeObserver)==null||c.observe(u.current.element),t&&u.current.scrollContainers&&u.current.scrollContainers.forEach(v=>v.addEventListener("scroll",h,{capture:!0,passive:!0})),u.current.orientationHandler=()=>{h()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",u.current.orientationHandler))}const y=c=>{!c||c===u.current.element||(g(),u.current.element=c,u.current.scrollContainers=Lt(c),b())};return en(h,!!t),Qr(l),d.useEffect(()=>{g(),b()},[t,h,l]),d.useEffect(()=>g,[]),[y,s,o]}function Qr(e){d.useEffect(()=>{const t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function en(e,t){d.useEffect(()=>{if(t){const r=e;return window.addEventListener("scroll",r,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",r,!0)}},[e,t])}function Lt(e){const t=[];if(!e||e===document.body)return t;const{overflow:r,overflowX:i,overflowY:a}=window.getComputedStyle(e);return[r,i,a].some(s=>s==="auto"||s==="scroll")&&t.push(e),[...t,...Lt(e.parentElement)]}const tn=["x","y","top","bottom","left","right","width","height"],rn=(e,t)=>tn.every(r=>e[r]===t[r]),nn=d.forwardRef(function({children:t,fallback:r,resize:i,style:a,gl:s,events:m=Kr,eventSource:u,eventPrefix:f,shadows:p,linear:n,flat:o,legacy:l,orthographic:h,frameloop:g,dpr:b,performance:y,raycaster:c,camera:v,scene:E,onPointerMissed:P,onCreated:S,...x},R){d.useMemo(()=>jr(sr),[]);const O=gr(),[C,_]=Jr({scroll:!0,debounce:{scroll:50,resize:0},...i}),w=d.useRef(null),M=d.useRef(null);d.useImperativeHandle(R,()=>w.current);const I=Et(P),[q,z]=d.useState(!1),[U,k]=d.useState(!1);if(q)throw q;if(U)throw U;const F=d.useRef(null);ve(()=>{const A=w.current;_.width>0&&_.height>0&&A&&(F.current||(F.current=Yr(A)),F.current.configure({gl:s,events:m,shadows:p,linear:n,flat:o,legacy:l,orthographic:h,frameloop:g,dpr:b,performance:y,raycaster:c,camera:v,scene:E,size:_,onPointerMissed:(...L)=>I.current==null?void 0:I.current(...L),onCreated:L=>{L.events.connect==null||L.events.connect(u?Lr(u)?u.current:u:M.current),f&&L.setEvents({compute:(B,j)=>{const Z=B[f+"X"],X=B[f+"Y"];j.pointer.set(Z/j.size.width*2-1,-(X/j.size.height)*2+1),j.raycaster.setFromCamera(j.pointer,j.camera)}}),S==null||S(L)}}),F.current.render(G.jsx(O,{children:G.jsx(xt,{set:k,children:G.jsx(d.Suspense,{fallback:G.jsx(Tr,{set:z}),children:t})})})))}),d.useEffect(()=>{const A=w.current;if(A)return()=>At(A)},[]);const H=u?"none":"auto";return G.jsx("div",{ref:M,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:H,...a},...x,children:G.jsx("div",{ref:C,style:{width:"100%",height:"100%"},children:G.jsx("canvas",{ref:w,style:{display:"block"},children:r})})})}),Dn=d.forwardRef(function(t,r){return G.jsx(hr,{children:G.jsx(nn,{...t,ref:r})})}),ge=new W,Ye=new W,on=new W,pt=new gt;function sn(e,t,r){const i=ge.setFromMatrixPosition(e.matrixWorld);i.project(t);const a=r.width/2,s=r.height/2;return[i.x*a+a,-(i.y*s)+s]}function an(e,t){const r=ge.setFromMatrixPosition(e.matrixWorld),i=Ye.setFromMatrixPosition(t.matrixWorld),a=r.sub(i),s=t.getWorldDirection(on);return a.angleTo(s)>Math.PI/2}function cn(e,t,r,i){const a=ge.setFromMatrixPosition(e.matrixWorld),s=a.clone();s.project(t),pt.set(s.x,s.y),r.setFromCamera(pt,t);const m=r.intersectObjects(i,!0);if(m.length){const u=m[0].distance;return a.distanceTo(r.ray.origin)<u}return!0}function ln(e,t){if(t instanceof Ue)return t.zoom;if(t instanceof Ge){const r=ge.setFromMatrixPosition(e.matrixWorld),i=Ye.setFromMatrixPosition(t.matrixWorld),a=t.fov*Math.PI/180,s=r.distanceTo(i);return 1/(2*Math.tan(a/2)*s)}else return 1}function un(e,t,r){if(t instanceof Ge||t instanceof Ue){const i=ge.setFromMatrixPosition(e.matrixWorld),a=Ye.setFromMatrixPosition(t.matrixWorld),s=i.distanceTo(a),m=(r[1]-r[0])/(t.far-t.near),u=r[1]-m*t.far;return Math.round(m*s+u)}}const Ne=e=>Math.abs(e)<1e-10?0:e;function Tt(e,t,r=""){let i="matrix3d(";for(let a=0;a!==16;a++)i+=Ne(t[a]*e.elements[a])+(a!==15?",":")");return r+i}const fn=(e=>t=>Tt(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),dn=(e=>(t,r)=>Tt(t,e(r),"translate(-50%,-50%)"))(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1]);function pn(e){return e&&typeof e=="object"&&"current"in e}const zn=d.forwardRef(({children:e,eps:t=.001,style:r,className:i,prepend:a,center:s,fullscreen:m,portal:u,distanceFactor:f,sprite:p=!1,transform:n=!1,occlude:o,onOcclude:l,castShadow:h,receiveShadow:g,material:b,geometry:y,zIndexRange:c=[16777271,0],calculatePosition:v=sn,as:E="div",wrapperClass:P,pointerEvents:S="auto",...x},R)=>{const{gl:O,camera:C,scene:_,size:w,raycaster:M,events:I,viewport:q}=N(),[z]=d.useState(()=>document.createElement(E)),U=d.useRef(),k=d.useRef(null),F=d.useRef(0),H=d.useRef([0,0]),A=d.useRef(null),L=d.useRef(null),B=(u==null?void 0:u.current)||I.connected||O.domElement.parentNode,j=d.useRef(null),Z=d.useRef(!1),X=d.useMemo(()=>o&&o!=="blending"||Array.isArray(o)&&o.length&&pn(o[0]),[o]);d.useLayoutEffect(()=>{const $=O.domElement;o&&o==="blending"?($.style.zIndex=`${Math.floor(c[0]/2)}`,$.style.position="absolute",$.style.pointerEvents="none"):($.style.zIndex=null,$.style.position=null,$.style.pointerEvents=null)},[o]),d.useLayoutEffect(()=>{if(k.current){const $=U.current=br(z);if(_.updateMatrixWorld(),n)z.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const D=v(k.current,C,w);z.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${D[0]}px,${D[1]}px,0);transform-origin:0 0;`}return B&&(a?B.prepend(z):B.appendChild(z)),()=>{B&&B.removeChild(z),$.unmount()}}},[B,n]),d.useLayoutEffect(()=>{P&&(z.className=P)},[P]);const Ke=d.useMemo(()=>n?{position:"absolute",top:0,left:0,width:w.width,height:w.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...m&&{top:-w.height/2,left:-w.width/2,width:w.width,height:w.height},...r},[r,s,m,w,n]),Ht=d.useMemo(()=>({position:"absolute",pointerEvents:S}),[S]);d.useLayoutEffect(()=>{if(Z.current=!1,n){var $;($=U.current)==null||$.render(d.createElement("div",{ref:A,style:Ke},d.createElement("div",{ref:L,style:Ht},d.createElement("div",{ref:R,className:i,style:r,children:e}))))}else{var D;(D=U.current)==null||D.render(d.createElement("div",{ref:R,style:Ke,className:i,children:e}))}});const ne=d.useRef(!0);he($=>{if(k.current){C.updateMatrixWorld(),k.current.updateWorldMatrix(!0,!1);const D=n?H.current:v(k.current,C,w);if(n||Math.abs(F.current-C.zoom)>t||Math.abs(H.current[0]-D[0])>t||Math.abs(H.current[1]-D[1])>t){const Q=an(k.current,C);let Y=!1;X&&(Array.isArray(o)?Y=o.map(ee=>ee.current):o!=="blending"&&(Y=[_]));const ue=ne.current;if(Y){const ee=cn(k.current,C,M,Y);ne.current=ee&&!Q}else ne.current=!Q;ue!==ne.current&&(l?l(!ne.current):z.style.display=ne.current?"block":"none");const ye=Math.floor(c[0]/2),It=o?X?[c[0],ye]:[ye-1,0]:c;if(z.style.zIndex=`${un(k.current,C,It)}`,n){const[ee,Qe]=[w.width/2,w.height/2],Pe=C.projectionMatrix.elements[5]*Qe,{isOrthographicCamera:et,top:Wt,left:Bt,bottom:$t,right:Nt}=C,Ut=fn(C.matrixWorldInverse),Gt=et?`scale(${Pe})translate(${Ne(-(Nt+Bt)/2)}px,${Ne((Wt+$t)/2)}px)`:`translateZ(${Pe}px)`;let te=k.current.matrixWorld;p&&(te=C.matrixWorldInverse.clone().transpose().copyPosition(te).scale(k.current.scale),te.elements[3]=te.elements[7]=te.elements[11]=0,te.elements[15]=1),z.style.width=w.width+"px",z.style.height=w.height+"px",z.style.perspective=et?"":`${Pe}px`,A.current&&L.current&&(A.current.style.transform=`${Gt}${Ut}translate(${ee}px,${Qe}px)`,L.current.style.transform=dn(te,1/((f||10)/400)))}else{const ee=f===void 0?1:ln(k.current,C)*f;z.style.transform=`translate3d(${D[0]}px,${D[1]}px,0) scale(${ee})`}H.current=D,F.current=C.zoom}}if(!X&&j.current&&!Z.current)if(n){if(A.current){const D=A.current.children[0];if(D!=null&&D.clientWidth&&D!=null&&D.clientHeight){const{isOrthographicCamera:Q}=C;if(Q||y)x.scale&&(Array.isArray(x.scale)?x.scale instanceof W?j.current.scale.copy(x.scale.clone().divideScalar(1)):j.current.scale.set(1/x.scale[0],1/x.scale[1],1/x.scale[2]):j.current.scale.setScalar(1/x.scale));else{const Y=(f||10)/400,ue=D.clientWidth*Y,ye=D.clientHeight*Y;j.current.scale.set(ue,ye,1)}Z.current=!0}}}else{const D=z.children[0];if(D!=null&&D.clientWidth&&D!=null&&D.clientHeight){const Q=1/q.factor,Y=D.clientWidth*Q,ue=D.clientHeight*Q;j.current.scale.set(Y,ue,1),Z.current=!0}j.current.lookAt($.camera.position)}});const Je=d.useMemo(()=>({vertexShader:n?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[n]);return d.createElement("group",K({},x,{ref:k}),o&&!X&&d.createElement("mesh",{castShadow:h,receiveShadow:g,ref:j},y||d.createElement("planeGeometry",null),b||d.createElement("shaderMaterial",{side:ar,vertexShader:Je.vertexShader,fragmentShader:Je.fragmentShader})))});let pe=0;const kn=wr(e=>(be.onStart=(t,r,i)=>{e({active:!0,item:t,loaded:r,total:i,progress:(r-pe)/(i-pe)*100})},be.onLoad=()=>{e({active:!1})},be.onError=t=>e(r=>({errors:[...r.errors,t]})),be.onProgress=(t,r,i)=>{r===i&&(pe=i),e({active:!0,item:t,loaded:r,total:i,progress:(r-pe)/(i-pe)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),Fe=e=>e===Object(e)&&!Array.isArray(e)&&typeof e!="function";function Dt(e,t){const r=N(s=>s.gl),i=J(Ve,Fe(e)?Object.values(e):e);return d.useLayoutEffect(()=>{t==null||t(i)},[t]),d.useEffect(()=>{if("initTexture"in r){let s=[];Array.isArray(i)?s=i:i instanceof We?s=[i]:Fe(i)&&(s=Object.values(i)),s.forEach(m=>{m instanceof We&&r.initTexture(m)})}},[r,i]),d.useMemo(()=>{if(Fe(e)){const s={};let m=0;for(const u in e)s[u]=i[m++];return s}else return i},[e,i])}Dt.preload=e=>J.preload(Ve,e);Dt.clear=e=>J.clear(Ve,e);const mn=()=>parseInt(cr.replace(/\D+/g,"")),zt=mn();function vn(e){return Array.isArray(e)}function He(e=[0,0,0]){return vn(e)?e:e instanceof W||e instanceof yt?[e.x,e.y,e.z]:[e,e,e]}const Fn=d.forwardRef(function({debug:t,depthTest:r=!1,polygonOffsetFactor:i=-10,map:a,mesh:s,children:m,position:u,rotation:f,scale:p,...n},o){const l=d.useRef(null);d.useImperativeHandle(o,()=>l.current);const h=d.useRef(null),g=d.useRef({position:new W,rotation:new yt,scale:new W(1,1,1)});return d.useLayoutEffect(()=>{const b=(s==null?void 0:s.current)||l.current.parent,y=l.current;if(!(b instanceof lr))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');if(b){V(g.current,{position:u,scale:p});const c=b.matrixWorld.clone();if(b.matrixWorld.identity(),!f||typeof f=="number"){const v=new ur;v.position.copy(g.current.position);const E=b.geometry.attributes.position.array;b.geometry.attributes.normal===void 0&&b.geometry.computeVertexNormals();const P=b.geometry.attributes.normal.array;let S=1/0;new W;let x=new W;const R=v.position.x,O=v.position.y,C=v.position.z,_=E.length;let w=-1;for(let M=0;M<_;M+=3){const I=E[M],q=E[M+1],z=E[M+2],U=I-R,k=q-O,F=z-C,H=U*U+k*k+F*F;H<S&&(S=H,w=M)}x.fromArray(P,w),v.lookAt(v.position.clone().add(x)),v.rotateZ(Math.PI),v.rotateY(Math.PI),typeof f=="number"&&v.rotateZ(f),V(g.current,{rotation:v.rotation})}else V(g.current,{rotation:f});return y.geometry=new Er(b,g.current.position,g.current.rotation,g.current.scale),b.matrixWorld=c,()=>{y.geometry.dispose()}}},[s,...He(u),...He(p),...He(f)]),d.useLayoutEffect(()=>{h.current&&(V(h.current,g.current),h.current.traverse(b=>b.raycast=()=>null))},[t]),d.createElement("mesh",K({ref:l,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":i,"material-depthTest":r,"material-map":a},n),m,t&&d.createElement("mesh",{ref:h},d.createElement("boxGeometry",null),d.createElement("meshNormalMaterial",{wireframe:!0}),d.createElement("axesHelper",null)))});let xe=null,kt="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Ft(e=!0,t=!0,r){return i=>{r&&r(i),e&&(xe||(xe=new xr),xe.setDecoderPath(typeof e=="string"?e:kt),i.setDRACOLoader(xe)),t&&i.setMeshoptDecoder(typeof Re=="function"?Re():Re)}}const Ze=(e,t,r,i)=>J(qe,e,Ft(t,r,i));Ze.preload=(e,t,r,i)=>J.preload(qe,e,Ft(t,r,i));Ze.clear=e=>J.clear(qe,e);Ze.setDecoderPath=e=>{kt=e};const Hn=d.forwardRef(({makeDefault:e,camera:t,regress:r,domElement:i,enableDamping:a=!0,keyEvents:s=!1,onChange:m,onStart:u,onEnd:f,...p},n)=>{const o=N(x=>x.invalidate),l=N(x=>x.camera),h=N(x=>x.gl),g=N(x=>x.events),b=N(x=>x.setEvents),y=N(x=>x.set),c=N(x=>x.get),v=N(x=>x.performance),E=t||l,P=i||g.connected||h.domElement,S=d.useMemo(()=>new Sr(E),[E]);return he(()=>{S.enabled&&S.update()},-1),d.useEffect(()=>(s&&S.connect(s===!0?P:s),S.connect(P),()=>void S.dispose()),[s,P,r,S,o]),d.useEffect(()=>{const x=C=>{o(),r&&v.regress(),m&&m(C)},R=C=>{u&&u(C)},O=C=>{f&&f(C)};return S.addEventListener("change",x),S.addEventListener("start",R),S.addEventListener("end",O),()=>{S.removeEventListener("start",R),S.removeEventListener("end",O),S.removeEventListener("change",x)}},[m,u,f,S,o,b]),d.useEffect(()=>{if(e){const x=c().controls;return y({controls:S}),()=>y({controls:x})}},[e,S]),d.createElement("primitive",K({ref:n,object:S,enableDamping:a},p))}),hn="modulepreload",gn=function(e){return"/Portfolio/"+e},mt={},In=function(t,r,i){if(!r||r.length===0)return t();const a=document.getElementsByTagName("link");return Promise.all(r.map(s=>{if(s=gn(s),s in mt)return;mt[s]=!0;const m=s.endsWith(".css"),u=m?'[rel="stylesheet"]':"";if(!!i)for(let n=a.length-1;n>=0;n--){const o=a[n];if(o.href===s&&(!m||o.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${u}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":hn,m||(p.as="script",p.crossOrigin=""),p.href=s,document.head.appendChild(p),m)return new Promise((n,o)=>{p.addEventListener("load",n),p.addEventListener("error",()=>o(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t()).catch(s=>{const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=s,window.dispatchEvent(m),!m.defaultPrevented)throw s})},Ie=zt>=154?"opaque_fragment":"output_fragment";class yn extends fr{constructor(t){super(t),this.onBeforeCompile=(r,i)=>{const{isWebGL2:a}=i.capabilities;r.fragmentShader=r.fragmentShader.replace(`#include <${Ie}>`,`
        ${a?`#include <${Ie}>`:`#extension GL_OES_standard_derivatives : enable
#include <${Ie}>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <${zt>=154?"colorspace_fragment":"encodings_fragment"}>
      `)}}}const Wn=d.forwardRef((e,t)=>{const[r]=d.useState(()=>new yn(null));return d.createElement("primitive",K({},e,{object:r,ref:t,attach:"material"}))}),Bn=d.forwardRef(({children:e,enabled:t=!0,speed:r=1,rotationIntensity:i=1,floatIntensity:a=1,floatingRange:s=[-.1,.1],autoInvalidate:m=!1,...u},f)=>{const p=d.useRef(null);d.useImperativeHandle(f,()=>p.current,[]);const n=d.useRef(Math.random()*1e4);return he(o=>{var l,h;if(!t||r===0)return;m&&o.invalidate();const g=n.current+o.clock.getElapsedTime();p.current.rotation.x=Math.cos(g/4*r)/8*i,p.current.rotation.y=Math.sin(g/4*r)/8*i,p.current.rotation.z=Math.sin(g/4*r)/20*i;let b=Math.sin(g/4*r)/10;b=dr.mapLinear(b,-.1,.1,(l=s==null?void 0:s[0])!==null&&l!==void 0?l:-.1,(h=s==null?void 0:s[1])!==null&&h!==void 0?h:.1),p.current.position.y=b*a,p.current.updateMatrix()}),d.createElement("group",u,d.createElement("group",{ref:p,matrixAutoUpdate:!1},e))});let re,me;const bn=d.createContext(null),vt=new pr,ht=new W,wn=d.forwardRef(({children:e,range:t,limit:r=1e3,...i},a)=>{const s=d.useRef(null);d.useImperativeHandle(a,()=>s.current,[]);const[m,u]=d.useState([]),[[f,p,n]]=d.useState(()=>[new Float32Array(r*3),Float32Array.from({length:r*3},()=>1),Float32Array.from({length:r},()=>1)]);d.useEffect(()=>{s.current.geometry.attributes.position.needsUpdate=!0}),he(()=>{for(s.current.updateMatrix(),s.current.updateMatrixWorld(),vt.copy(s.current.matrixWorld).invert(),s.current.geometry.drawRange.count=Math.min(r,t!==void 0?t:r,m.length),re=0;re<m.length;re++)me=m[re].current,me.getWorldPosition(ht).applyMatrix4(vt),ht.toArray(f,re*3),s.current.geometry.attributes.position.needsUpdate=!0,me.matrixWorldNeedsUpdate=!0,me.color.toArray(p,re*3),s.current.geometry.attributes.color.needsUpdate=!0,n.set([me.size],re),s.current.geometry.attributes.size.needsUpdate=!0});const o=d.useMemo(()=>({getParent:()=>s,subscribe:l=>(u(h=>[...h,l]),()=>u(h=>h.filter(g=>g.current!==l.current)))}),[]);return d.createElement("points",K({userData:{instances:m},matrixAutoUpdate:!1,ref:s,raycast:()=>null},i),d.createElement("bufferGeometry",null,d.createElement("bufferAttribute",{attach:"attributes-position",count:f.length/3,array:f,itemSize:3,usage:ce}),d.createElement("bufferAttribute",{attach:"attributes-color",count:p.length/3,array:p,itemSize:3,usage:ce}),d.createElement("bufferAttribute",{attach:"attributes-size",count:n.length,array:n,itemSize:1,usage:ce})),d.createElement(bn.Provider,{value:o},e))}),En=d.forwardRef(({children:e,positions:t,colors:r,sizes:i,stride:a=3,...s},m)=>{const u=d.useRef(null);return d.useImperativeHandle(m,()=>u.current,[]),he(()=>{const f=u.current.geometry.attributes;f.position.needsUpdate=!0,r&&(f.color.needsUpdate=!0),i&&(f.size.needsUpdate=!0)}),d.createElement("points",K({ref:u},s),d.createElement("bufferGeometry",null,d.createElement("bufferAttribute",{attach:"attributes-position",count:t.length/a,array:t,itemSize:a,usage:ce}),r&&d.createElement("bufferAttribute",{attach:"attributes-color",count:r.length/a,array:r,itemSize:3,usage:ce}),i&&d.createElement("bufferAttribute",{attach:"attributes-size",count:i.length/a,array:i,itemSize:1,usage:ce})),e)}),$n=d.forwardRef((e,t)=>e.positions instanceof Float32Array?d.createElement(En,K({},e,{ref:t})):d.createElement(wn,K({},e,{ref:t})));function Nn({all:e,scene:t,camera:r}){const i=N(({gl:m})=>m),a=N(({camera:m})=>m),s=N(({scene:m})=>m);return d.useLayoutEffect(()=>{const m=[];e&&(t||s).traverse(p=>{p.visible===!1&&(m.push(p),p.visible=!0)}),i.compile(t||s,r||a);const u=new mr(128);new vr(.01,1e5,u).update(i,t||s),u.dispose(),m.forEach(p=>p.visible=!1)},[]),null}export{Dn as C,Fn as D,Bn as F,zn as H,Hn as O,Nn as P,In as _,Ze as a,Dt as b,he as c,$n as d,Wn as e,kn as u};
